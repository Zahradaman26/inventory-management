<div class="dashboard-main-body">
    <app-breadcrumb [title]="title"></app-breadcrumb>

    <!-- Loading Indicator -->
    <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2 text-secondary">Loading profile...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="alert alert-danger alert-dismissible fade show mb-3" role="alert">
        {{ error }}
        <button type="button" class="btn-close" (click)="error = null"></button>
    </div>

    <!-- Success Message -->
    <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show mb-3" role="alert">
        {{ successMessage }}
        <button type="button" class="btn-close" (click)="successMessage = null"></button>
    </div>

    <div class="row justify-content-center" *ngIf="!loading && currentUser">
        <!-- Centered Profile Card -->
        <div class="col-lg-8 col-xl-6"> <!-- Reduced width for better centering -->
            <div class="user-grid-card position-relative border radius-16 overflow-hidden bg-base h-100">
                <img src="assets/images/user-grid/user-grid-bg1.png" alt="" class="w-100 object-fit-cover">
                <div class="pb-24 ms-16 mb-24 me-16 mt--100">
                    <div class="text-center border border-top-0 border-start-0 border-end-0">
                        <div class="border br-white border-width-2-px w-200-px h-200-px rounded-circle object-fit-cover mx-auto overflow-hidden">
                            <img [src]="currentUser.imgSrc || 'assets/images/user.jpg'" 
                                 [alt]="currentUser.name"
                                 class="w-100 h-100 object-fit-cover">
                        </div>
                        <h6 class="mb-0 mt-16">{{ currentUser.name || 'No Name' }}</h6>
                        <span class="text-secondary-light mb-16">{{ currentUser.email || 'No Email' }}</span>
                    </div>
                    <div class="mt-24">
                        <h6 class="text-xl mb-16 text-center">Personal Information</h6>
                        <div class="row justify-content-center">
                            <div class="col-md-10"> <!-- Centered content within card -->
                                <ul class="list-unstyled">
                                    <li class="d-flex align-items-center mb-16">
                                        <div class="w-40 text-md fw-semibold text-primary-light">Full Name: </div>
                                        <div class="w-60 text-secondary-light fw-medium">{{ currentUser.name || 'N/A' }}</div>
                                    </li>
                                    <li class="d-flex align-items-center mb-16">
                                        <div class="w-40 text-md fw-semibold text-primary-light">Email: </div>
                                        <div class="w-60 text-secondary-light fw-medium">{{ currentUser.email || 'N/A' }}</div>
                                    </li>
                                    <li class="d-flex align-items-center mb-16">
                                        <div class="w-40 text-md fw-semibold text-primary-light">Contact Number: </div>
                                        <div class="w-60 text-secondary-light fw-medium">{{ currentUser.contactNumber || 'N/A' }}</div>
                                    </li>
                                    <li class="d-flex align-items-center mb-16">
                                        <div class="w-40 text-md fw-semibold text-primary-light">Role: </div>
                                        <div class="w-60 text-secondary-light fw-medium">{{ currentUser.role || 'N/A' }}</div>
                                    </li>
                                    <li class="d-flex align-items-center mb-16">
                                        <div class="w-40 text-md fw-semibold text-primary-light">Status: </div>
                                        <div class="w-60 text-secondary-light fw-medium">
                                            <span [ngClass]="{'text-success-main': currentUser.status === 'Active', 'text-danger-main': currentUser.status === 'Inactive'}">
                                                {{ currentUser.status || 'N/A' }}
                                            </span>
                                        </div>
                                    </li>
                                    <li class="d-flex align-items-center mb-16">
                                        <div class="w-40 text-md fw-semibold text-primary-light">Join Date: </div>
                                        <div class="w-60 text-secondary-light fw-medium">{{ (currentUser.joinDate | date) || 'N/A' }}</div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 
    The edit form code remains commented below
    <div class="col-lg-8">
        <div class="card h-100">
            <div class="card-body p-24">
                <ul class="nav border-gradient-tab nav-pills mb-20 d-inline-flex" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link d-flex align-items-center px-24 active" id="pills-edit-profile-tab"
                            data-bs-toggle="pill" data-bs-target="#pills-edit-profile" type="button" role="tab"
                            aria-controls="pills-edit-profile" aria-selected="true">
                            Edit Profile
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link d-flex align-items-center px-24" id="pills-change-passwork-tab"
                            data-bs-toggle="pill" data-bs-target="#pills-change-passwork" type="button" role="tab"
                            aria-controls="pills-change-passwork" aria-selected="false" tabindex="-1">
                            Change Password
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="pills-tabContent">
                    
                    <div class="tab-pane fade show active" id="pills-edit-profile" role="tabpanel"
                        aria-labelledby="pills-edit-profile-tab" tabindex="0">
                        <h6 class="text-md text-primary-light mb-16">Profile Image</h6>
                        
                        <div class="mb-24 mt-16">
                            <div class="avatar-upload">
                                <div class="avatar-edit position-absolute bottom-0 end-0 me-24 mt-16 z-1 cursor-pointer">
                                    <input type='file' id="imageUpload" accept=".png, .jpg, .jpeg" hidden (change)="onFileSelected($event)">
                                    <label for="imageUpload"
                                        class="w-32-px h-32-px d-flex justify-content-center align-items-center bg-primary-50 text-primary-600 border border-primary-600 bg-hover-primary-100 text-lg rounded-circle">
                                        <iconify-icon icon="solar:camera-outline" class="icon"></iconify-icon>
                                    </label>
                                </div>
                            
                                <div class="avatar-preview">
                                    <div id="imagePreview" [ngStyle]="{'background-image': imagePreview ? 'url(' + imagePreview + ')' : (currentUser.imgSrc ? 'url(' + currentUser.imgSrc + ')' : 'url(assets/images/user.jpg)')}">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        
                        <form [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="mb-20">
                                        <label for="name" class="form-label fw-semibold text-primary-light text-sm mb-8">
                                            Full Name <span class="text-danger-600">*</span>
                                        </label>
                                        <input type="text" class="form-control radius-8" id="name"
                                            formControlName="name" placeholder="Enter Full Name">
                                        <div *ngIf="profileFormControls['name'].invalid && (profileFormControls['name'].dirty || profileFormControls['name'].touched)" 
                                             class="text-danger small mt-1">
                                            <div *ngIf="profileFormControls['name'].errors?.['required']">Name is required</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="mb-20">
                                        <label for="email" class="form-label fw-semibold text-primary-light text-sm mb-8">
                                            Email <span class="text-danger-600">*</span>
                                        </label>
                                        <input type="email" class="form-control radius-8" id="email"
                                            formControlName="email" placeholder="Enter email address">
                                        <div *ngIf="profileFormControls['email'].invalid && (profileFormControls['email'].dirty || profileFormControls['email'].touched)" 
                                             class="text-danger small mt-1">
                                            <div *ngIf="profileFormControls['email'].errors?.['required']">Email is required</div>
                                            <div *ngIf="profileFormControls['email'].errors?.['email']">Enter a valid email</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="mb-20">
                                        <label for="number" class="form-label fw-semibold text-primary-light text-sm mb-8">
                                            Contact Number <span class="text-danger-600">*</span>
                                        </label>
                                        <input type="text" class="form-control radius-8" id="number"
                                            formControlName="contactNumber" placeholder="Enter contact number">
                                        <div *ngIf="profileFormControls['contactNumber'].invalid && (profileFormControls['contactNumber'].dirty || profileFormControls['contactNumber'].touched)" 
                                             class="text-danger small mt-1">
                                            <div *ngIf="profileFormControls['contactNumber'].errors?.['required']">Contact number is required</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="mb-20">
                                        <label for="role" class="form-label fw-semibold text-primary-light text-sm mb-8">
                                            Role <span class="text-danger-600">*</span>
                                        </label>
                                        <select class="form-control radius-8 form-select" id="role" formControlName="role">
                                            <option value="">Select Role</option>
                                            <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
                                        </select>
                                        <div *ngIf="profileFormControls['role'].invalid && (profileFormControls['role'].dirty || profileFormControls['role'].touched)" 
                                             class="text-danger small mt-1">
                                            <div *ngIf="profileFormControls['role'].errors?.['required']">Role is required</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex align-items-center justify-content-center gap-3">
                                <button type="button" (click)="onCancel()"
                                    class="border border-danger-600 bg-hover-danger-200 text-danger-600 text-md px-56 py-11 radius-8">
                                    Cancel
                                </button>
                                <button type="submit" [disabled]="profileForm.invalid || loading"
                                    class="btn btn-primary border border-primary-600 text-md px-56 py-12 radius-8">
                                    <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                                    {{ loading ? 'Saving...' : 'Save Changes' }}
                                </button>
                            </div>
                        </form>
                    </div>

                    
                    <div class="tab-pane fade" id="pills-change-passwork" role="tabpanel"
                        aria-labelledby="pills-change-passwork-tab" tabindex="0">
                        <form [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()">
                            
                            <div class="mb-20">
                                <label for="newPassword" class="form-label fw-semibold text-primary-light text-sm mb-8">
                                    New Password <span class="text-danger-600">*</span>
                                </label>
                                <div class="position-relative">
                                    <input [type]="showNewPassword ? 'text' : 'password'" 
                                           class="form-control radius-8" id="newPassword"
                                           formControlName="newPassword" placeholder="Enter New Password*">
                                    <span class="cursor-pointer position-absolute end-0 top-50 translate-middle-y me-16 text-secondary-light"
                                        [ngClass]="showNewPassword ? 'ri-eye-off-line' : 'ri-eye-line'"
                                        (click)="togglePassword('new')">
                                    </span>
                                </div>
                                <div *ngIf="passwordFormControls['newPassword'].invalid && (passwordFormControls['newPassword'].dirty || passwordFormControls['newPassword'].touched)" 
                                     class="text-danger small mt-1">
                                    <div *ngIf="passwordFormControls['newPassword'].errors?.['required']">Password is required</div>
                                    <div *ngIf="passwordFormControls['newPassword'].errors?.['minlength']">Password must be at least 6 characters</div>
                                </div>
                            </div>

                            
                            <div class="mb-20">
                                <label for="confirmPassword" class="form-label fw-semibold text-primary-light text-sm mb-8">
                                    Confirm Password <span class="text-danger-600">*</span>
                                </label>
                                <div class="position-relative">
                                    <input [type]="showConfirmPassword ? 'text' : 'password'"
                                        class="form-control radius-8" id="confirmPassword"
                                        formControlName="confirmPassword" placeholder="Confirm Password*">
                                    <span class="cursor-pointer position-absolute end-0 top-50 translate-middle-y me-16 text-secondary-light"
                                        [ngClass]="showConfirmPassword ? 'ri-eye-off-line' : 'ri-eye-line'"
                                        (click)="togglePassword('confirm')">
                                    </span>
                                </div>
                                <div *ngIf="passwordFormControls['confirmPassword'].invalid && (passwordFormControls['confirmPassword'].dirty || passwordFormControls['confirmPassword'].touched)" 
                                     class="text-danger small mt-1">
                                    <div *ngIf="passwordFormControls['confirmPassword'].errors?.['required']">Please confirm your password</div>
                                </div>
                                <div *ngIf="passwordForm.errors?.['passwordMismatch'] && (passwordForm.dirty || passwordForm.touched)" 
                                     class="text-danger small mt-1">
                                    Passwords do not match
                                </div>
                            </div>
                            
                            <div class="d-flex align-items-center justify-content-center gap-3">
                                <button type="button" (click)="onCancel()"
                                    class="border border-danger-600 bg-hover-danger-200 text-danger-600 text-md px-56 py-11 radius-8">
                                    Cancel
                                </button>
                                <button type="submit" [disabled]="passwordForm.invalid || loading"
                                    class="btn btn-primary border border-primary-600 text-md px-56 py-12 radius-8">
                                    <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                                    {{ loading ? 'Changing...' : 'Change Password' }}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div> -->